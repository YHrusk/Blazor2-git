@page "/vybaveni/{Id:guid}/ukon"
@inject HttpClient Http

<h3>Ukon vybaveni:</h3>

@if (item == null)
{
    <Loading></Loading>
    return;
}

<div class="container mx-auto">
    <div class="max-w-xl p-5 mx-auto my-10 bg-white rounded-md border-solid border-2 border-sky-600">
        <div class="text-center">
            <h2>ID vybaveni: @item.Id</h2>
        </div>
        <div class="mb-6">
            <label for="nazev" class="block mb-2 text-sm text-gray-600">Název:</label>
            <input type="text" id="nazev" @bind="@nazev" class="w-1/3 px-4 py-2 border border-gray-300 outline-none focus:border-gray-400 rounded-md" style="width:100%" required>
        </div>
        <div class="mb-6">
            <label for="info" class="block mb-2 text-sm text-gray-600">Info:</label>
            <input type="text" id="info" @bind="info" class="w-1/3 px-4 py-2 border border-gray-300 outline-none focus:border-gray-400 rounded-md" style="width:100%" required>
        </div>
        <div class="mb-6">
            <label for="date" class="block mb-2 text-sm text-gray-600">Datum:</label>
            <input type="date" id="date" @bind="date" class="w-1/3 px-4 py-2 border border-gray-300 outline-none focus:border-gray-400 rounded-md" style="width:100%">
        </div>
        <button @onclick="PridejUkon" class="twbtn bg-blue-400">Přidat úkon</button>
        <a class="twbtn bg-yellow-400" href="/vybaveni/@item.Id" style="display:inline-block;">Zrušit a zpět na detail</a>
    </div>
</div>

@code {
    [Parameter] public Guid Id { get; set; }

    VybaveniSRevizesModel? item;

    private string nazev;
    private string info;
    private DateTime date;

    protected override async Task OnInitializedAsync()
    {
        item = await Http.GetFromJsonAsync<VybaveniSRevizesModel>($"vybaveni/{Id}");
    }

    private async Task PridejUkon()
    {
        UkonModel novyUkon = new() { Name = nazev, Info = info, DateTime = date, VybaveniId = item!.Id };
        var resp = await Http.PostAsJsonAsync("ukon", novyUkon);
        if (!resp.IsSuccessStatusCode) return;
    }
}
